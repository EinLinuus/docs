"use strict";(self.webpackChunkcontabo_docs=self.webpackChunkcontabo_docs||[]).push([[921],{3905:function(e,t,n){n.d(t,{Zo:function(){return u},kt:function(){return b}});var i=n(7294);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,i,o=function(e,t){if(null==e)return{};var n,i,o={},r=Object.keys(e);for(i=0;i<r.length;i++)n=r[i],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(i=0;i<r.length;i++)n=r[i],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var l=i.createContext({}),c=function(e){var t=i.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):a(a({},t),e)),n},u=function(e){var t=c(e.components);return i.createElement(l.Provider,{value:t},e.children)},p={inlineCode:"code",wrapper:function(e){var t=e.children;return i.createElement(i.Fragment,{},t)}},d=i.forwardRef((function(e,t){var n=e.components,o=e.mdxType,r=e.originalType,l=e.parentName,u=s(e,["components","mdxType","originalType","parentName"]),d=c(n),b=o,g=d["".concat(l,".").concat(b)]||d[b]||p[b]||r;return n?i.createElement(g,a(a({ref:t},u),{},{components:n})):i.createElement(g,a({ref:t},u))}));function b(e,t){var n=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var r=n.length,a=new Array(r);a[0]=d;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s.mdxType="string"==typeof e?e:o,a[1]=s;for(var c=2;c<r;c++)a[c]=n[c];return i.createElement.apply(null,a)}return i.createElement.apply(null,n)}d.displayName="MDXCreateElement"},4723:function(e,t,n){n.r(t),n.d(t,{assets:function(){return u},contentTitle:function(){return l},default:function(){return b},frontMatter:function(){return s},metadata:function(){return c},toc:function(){return p}});var i=n(7462),o=n(3366),r=(n(7294),n(3905)),a=["components"],s={title:"Versioning",sidebar_position:6},l="Bucket Versioning",c={unversionedId:"Object-Storage/HowTo/versioning",id:"Object-Storage/HowTo/versioning",title:"Versioning",description:"Wit S3 compatible Object Storage you can use versioning. This enables to keep multiple versions of an object. So that if you upload a object / file with the same name the S3 Object Storage system will store a version from the previous contents. This version will be also stored in the bucket and will not be directly visible.",source:"@site/docs/Object-Storage/HowTo/versioning.md",sourceDirName:"Object-Storage/HowTo",slug:"/Object-Storage/HowTo/versioning",permalink:"/docs/Object-Storage/HowTo/versioning",editUrl:"https://github.com/contabo/docs/tree/main/docs/Object-Storage/HowTo/versioning.md",tags:[],version:"current",sidebarPosition:6,frontMatter:{title:"Versioning",sidebar_position:6},sidebar:"tutorialSidebar",previous:{title:"Use Object Locking",permalink:"/docs/Object-Storage/HowTo/object-locking"},next:{title:"Restricting Users to Buckets",permalink:"/docs/Object-Storage/HowTo/restricting-user-bucket"}},u={},p=[{value:"Enable Bucket Versioning",id:"enable-bucket-versioning",level:2},{value:"List and Retrieve old Versions",id:"list-and-retrieve-old-versions",level:2},{value:"Check Versioning State",id:"check-versioning-state",level:3},{value:"List versioned objects",id:"list-versioned-objects",level:3},{value:"Get a specific version",id:"get-a-specific-version",level:3},{value:"Disable Bucket Versioning",id:"disable-bucket-versioning",level:2},{value:"Hint",id:"hint",level:2}],d={toc:p};function b(e){var t=e.components,n=(0,o.Z)(e,a);return(0,r.kt)("wrapper",(0,i.Z)({},d,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"bucket-versioning"},"Bucket Versioning"),(0,r.kt)("p",null,"Wit S3 compatible Object Storage you can use versioning. This enables to keep multiple versions of an object. So that if you upload a object / file with the same name the S3 Object Storage system will store a version from the previous contents. This version will be also stored in the bucket and will not be directly visible."),(0,r.kt)("p",null,"This How-To shows how to enable it via ",(0,r.kt)("a",{parentName:"p",href:"/docs/Object-Storage/Tools/aws-cli"},"aws cli")," tool and how to list and retrieve older versions of files. Of course disabling it will also be shown."),(0,r.kt)("p",null,"Please keep in mind that this feature is not enabled for a specific file but for an entire bucket."),(0,r.kt)("h2",{id:"enable-bucket-versioning"},"Enable Bucket Versioning"),(0,r.kt)("p",null,"In order to enable Bucket Versioning please exectute e.g. the following:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"aws --profile eu2 --region default --endpoint-url https://eu2.contabostorage.com s3api put-bucket-versioning --bucket bucket-with-versioning --versioning-configuration Status=Enabled\n")),(0,r.kt)("h2",{id:"list-and-retrieve-old-versions"},"List and Retrieve old Versions"),(0,r.kt)("h3",{id:"check-versioning-state"},"Check Versioning State"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"aws --profile eu2 --region default --endpoint-url https://eu2.contabostorage.com s3api get-bucket-versioning --bucket bucket-with-versioning\n")),(0,r.kt)("p",null,"If result is empty, then versioning is disabled."),(0,r.kt)("h3",{id:"list-versioned-objects"},"List versioned objects"),(0,r.kt)("p",null,"For all objects simply invoke:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"aws --profile eu2 --region default --endpoint-url https://eu2.contabostorage.com s3api list-object-versions --bucket bucket-with-versioning\n")),(0,r.kt)("p",null,"For a specific file / object, in this case ",(0,r.kt)("inlineCode",{parentName:"p"},"image003.png")," for example:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"aws --profile eu2 --region default --endpoint-url https://eu2.contabostorage.com s3api list-object-versions --bucket bucket-with-versioning --prefix image003.png\n")),(0,r.kt)("p",null,"Sample output would be:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-json"},'{\n    "Versions": [\n        {\n            "ETag": "\\"8f92d5c306c850b5081eab5c6090a0ea\\"",\n            "Size": 470117,\n            "StorageClass": "STANDARD",\n            "Key": "image003.png",\n            "VersionId": "qhV3FW5iRSu1i1d2ahPerBUe5CLLRKS",\n            "IsLatest": true,\n            "LastModified": "2022-04-05T12:24:29.707000+00:00",\n            "Owner": {\n                "DisplayName": "12345",\n                "ID": "5c37e60c3ee04f1eb116c436b1afadca$12345"\n            }\n        },\n        {\n            "ETag": "\\"13785d0138c0ce23b6104743684e96dc\\"",\n            "Size": 457745,\n            "StorageClass": "STANDARD",\n            "Key": "image003.png",\n            "VersionId": "L-6oXdYnuAF1orfDEAHV3mDIliEoB9.",\n            "IsLatest": false,\n            "LastModified": "2022-04-05T12:23:45.488000+00:00",\n            "Owner": {\n                "DisplayName": "12345",\n                "ID": "5c37e60c3ee04f1eb116c436b1afadca$12345"\n            }\n        }\n    ]\n}\n')),(0,r.kt)("p",null,"The current version which is also returned in regular file listings is the one where ",(0,r.kt)("inlineCode",{parentName:"p"},"IsLatest")," is ",(0,r.kt)("inlineCode",{parentName:"p"},"true"),"."),(0,r.kt)("h3",{id:"get-a-specific-version"},"Get a specific version"),(0,r.kt)("p",null,"In order to access and older version of the file ",(0,r.kt)("inlineCode",{parentName:"p"},"image003.png")," please use the ",(0,r.kt)("inlineCode",{parentName:"p"},"VersionId")," from the output above:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"aws --profile eu2 --region default --endpoint-url https://eu2.contabostorage.com s3api get-object --bucket bucket-with-versioning --version-id 'L-6oXdYnuAF1orfDEAHV3mDIliEoB9.' --key image003.png image003.png\n")),(0,r.kt)("h2",{id:"disable-bucket-versioning"},"Disable Bucket Versioning"),(0,r.kt)("p",null,"To disable or suspend the Bucket Versioning please proceed as follows:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"aws --profile eu2 --region default --endpoint-url https://eu2.contabostorage.com s3api put-bucket-versioning --bucket bucket-with-versioning --versioning-configuration Status=Suspended\n")),(0,r.kt)("p",null,"Please note that old versions won't be deleted if you turn off Bucket Versioning. No new versions will be created, that's all."),(0,r.kt)("h2",{id:"hint"},"Hint"),(0,r.kt)("p",null,"Tools like ",(0,r.kt)("a",{parentName:"p",href:"/docs/Object-Storage/Tools/cyberduck"},"Cyberduck")," are making these tasks very easy. Just do a ",(0,r.kt)("inlineCode",{parentName:"p"},"Info")," on a bucket and check ",(0,r.kt)("inlineCode",{parentName:"p"},"Bucket Versioning"),". Please also enable via ",(0,r.kt)("inlineCode",{parentName:"p"},"View")," -> ",(0,r.kt)("inlineCode",{parentName:"p"},"Show Hidden Files")," the display of all versions."))}b.isMDXComponent=!0}}]);